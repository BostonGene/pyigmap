// Global default params, used in configs
params {
    // Inputs
    zenodo_link = 'https://zenodo.org/records/11103555/files/'

    // Outputs
    outdir = './results'
    out_stat_json = 'stat.json'
    out_corrected_annotation = 'corrected_annotation.tsv'
    out_archive = 'pyigmap.tar.gz'

    // Fastp parameters
    insert_size = 1
}

process {
    withName:GetLinks {
        container = 'downloader'
    }
    withName:Download {
        container = 'downloader'
        publishDir = [
            path: "${params.outdir}/downloader",
            enabled: false,
            mode: 'copy'
        ]
    }
    withName:Downsample {
        container = 'downloader'
        publishDir = [
            path: "${params.outdir}/downsample",
            enabled: false,
            mode: 'copy'
        ]
    }
    withName:CalibDedup {
        container = 'calib-dedup-image'
        publishDir = [
            path: "${params.outdir}/calib_dedup",
            enabled: false,
            mode: 'copy'
        ]
    }
    withName:Fastp {
        container = 'fastp-image'
        publishDir = [
            path: "${params.outdir}/fastp",
            enabled: false,
            mode: 'copy'
        ]
    }
    withName:Vidjil {
        container = 'vidjil-image'
        publishDir = [
            path: "${params.outdir}/vidjil",
            enabled: false,
            mode: 'copy'
        ]
    }
    withName:IgBlast {
        container = 'igblast-image'
        publishDir = [
            path: "${params.outdir}/igblast",
            enabled: false,
            mode: 'copy'
        ]
    }
    withName:CDR3ErrorCorrector {
        container = 'cdr3nt-error-corrector-image'
        publishDir = [
            path: params.outdir,
            mode: 'copy'
        ]
    }
}

docker {
    enabled = true
    remove = true
}

manifest {
    name            = 'bostongene/pyigmap'
    defaultBranch   = 'main'
    homePage        = 'https://github.com/bostongene/pyigmap'
    mainScript      = 'main.nf'
    nextflowVersion = '>=23.10.1'
}